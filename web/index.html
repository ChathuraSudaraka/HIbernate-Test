<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Student CRUD (Hibernate + Servlet)</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 1.5rem;
            background: #f7f7f9;
        }

        h1 {
            margin-top: 0;
        }

        fieldset {
            margin-bottom: 1rem;
            border: 1px solid #bbb;
            padding: 0.75rem 1rem;
            background: #fff;
        }

        legend {
            font-weight: bold;
        }

        label {
            display: inline-block;
            width: 70px;
        }

        input[type=text],
        input[type=number] {
            padding: 4px;
        }

        button {
            cursor: pointer;
            margin-top: 0.4rem;
        }

        #log {
            white-space: pre;
            background: #111;
            color: #0f0;
            padding: 0.5rem;
            min-height: 120px;
            overflow: auto;
        }

        table {
            border-collapse: collapse;
            width: 100%;
            background: #fff;
        }

        th,
        td {
            border: 1px solid #ccc;
            padding: 4px 6px;
            font-size: 14px;
        }

        th {
            background: #e9e9e9;
        }

        .row {
            margin-bottom: 0.4rem;
        }

        .actions button {
            margin-right: 0.5rem;
        }
    </style>
</head>

<body>
    <h1>Student CRUD Demo</h1>
    <p>Forms call the backend REST-style servlet endpoints:<br>
        GET <code>/student</code> (list) • GET <code>/student/{id}</code> • GET <code>/student?name=...</code> • POST
        <code>/student</code> • PUT <code>/student/{id}</code> • DELETE <code>/student/{id}</code>.
    </p>

    <!--
    <fieldset>
        <legend>Create</legend>
        <div class="row">
            <label for="cName">Name</label>
            <input id="cName" type="text" />
            <label for="cAge">Age</label>
            <input id="cAge" type="number" min="0" />
            <button onclick="createStudent()">Create</button>
        </div>
    </fieldset>

    <fieldset>
        <legend>Get One</legend>
        <label for="gId">ID</label>
        <input id="gId" type="number" min="1" />
        <button onclick="getStudent()">Get</button>
    </fieldset>

    <fieldset>
        <legend>Update</legend>
        <label for="uId">ID</label>
        <input id="uId" type="number" min="1" />
        <label for="uName">Name</label>
        <input id="uName" type="text" />
        <label for="uAge">Age</label>
        <input id="uAge" type="number" min="0" />
        <button onclick="updateStudent()">Update</button>
    </fieldset>

    <fieldset>
        <legend>Delete</legend>
        <label for="dId">ID</label>
        <input id="dId" type="number" min="1" />
        <button onclick="deleteStudent()">Delete</button>
    </fieldset>

    <fieldset>
        <legend>Find By Name</legend>
        <label for="fName">Name</label>
        <input id="fName" type="text" />
        <button onclick="findByName()">Find</button>
    </fieldset>

    <fieldset>
        <legend>List All</legend>
        <button onclick="listAll()">Refresh List</button>
    </fieldset>
    -->

    <h2>Students</h2>
    <table id="studentsTbl">
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Age</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>

    <h2>Raw Response Log</h2>
    <div id="log"></div>

    <script>
    // Minimal: fetch and render student list only, robust for object-like servlet output
    async function fetchStudents() {
        const res = await fetch('student');
        const raw = await res.text();
        document.getElementById('log').textContent = raw.trim();
        const rows = [];
        raw.trim().split(/\n+/).forEach(line => {
            // Match: { id=1, name='Alice', age=20 }
            const m = line.match(/\{\s*id=(\d+),\s*name='([^']*)',\s*age=([\d]*)\s*\}/);
            if (m) rows.push({ id: m[1], name: m[2], age: m[3] });
        });
        const tb = document.querySelector('#studentsTbl tbody');
        tb.innerHTML = rows.length ? rows.map(r => `<tr><td>${r.id}</td><td>${r.name}</td><td>${r.age||''}</td></tr>`).join('') : '<tr><td colspan="3">No students found</td></tr>';
    }
    fetchStudents();
    </script>
</body>

</html>